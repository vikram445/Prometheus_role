pipeline {
  agent any
    environment {
   ANSIBLE_PRIVATE_KEY=credentials('Prometheus.pem') 
  }
  stages {

stage('list Ubuntu') {
      steps {
        sh 'ansible-inventory --graph'
      }
    }

stage('Ping Ubuntu') {
      steps {
        sh 'ansible  --private-key=$ANSIBLE_PRIVATE_KEY  -u ubuntu -m ping localhost'
        sh 'ansible  --private-key=$ANSIBLE_PRIVATE_KEY  -u ubuntu -m ping tag_Name_prom'
      }
    }

 
    stage('running Prometheus role') {
      steps {
         sh 'ansible-playbook --private-key=$ANSIBLE_PRIVATE_KEY -u ubuntu node_exp/tests/test.yml'
           sh './home/node_exp/node_exporter-1.7.0.linux-amd64/node_exporer &'
      }
    }
  }
}
